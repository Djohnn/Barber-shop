<form method="post">
    {% csrf_token %}
    <p>Venda {{ venda.id }}</p>
    <p>Valor Total: {{ venda.valor_total }}</p>
    <label for="forma_pagamento">Forma de Pagamento:</label>
    <select name="forma_pagamento" id="forma_pagamento">
        <option value="Dinheiro">Dinheiro</option>
        <option value="Cartão Débito">Cartão Débito</option>
        <option value="Cartão Crédito">Cartão Crédito</option>
        <option value="Pix">Pix</option>
    </select>
    <button type="submit">Registrar Pagamento</button>
</form>

<img id="qr_code_pix" src="{% if qr_code_pix_base64 %}data:image/png;base64,{{ qr_code_pix_base64 }}{% endif %}" style="{% if not qr_code_pix_base64 %}display:none;{% endif %}"/>
<script>
    document.getElementById('forma_pagamento').addEventListener('change', function() {
        if (this.value === 'Pix') {
            // Mostra o QR Code Pix
            fetch("{% url 'gerar_qr_code_pix' venda.pk %}")
                .then(response => response.json())
                .then(data => {
                    document.getElementById('qr_code_pix').src = 'data:image/png;base64,' + data.qr_code_pix;
                    document.getElementById('qr_code_pix').style.display = 'block';
                });
        } else {
            // Esconde o QR Code Pix
            document.getElementById('qr_code_pix').style.display = 'none';
        }
    });
</script>
